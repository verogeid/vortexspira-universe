/* --- styles/style-details.css --- */

/* 1. Scroll interno y Contenedores */
/* Aplica tanto al contenedor de escritorio como al de m칩vil */
#detalle-contenido-desktop, 
#detalle-contenido-mobile {
    max-height: 100%; 
    overflow-y: auto; 
    padding-right: 10px;
    scrollbar-width: thin;
    scrollbar-color: var(--color-primary) transparent;
    /* Asegura comportamiento suave */
    scroll-behavior: smooth;
}

/* 2. BLOQUE DE TEXTO Y FRAGMENTOS */

/* Contenedor principal de texto (Ahora solo un wrapper) */
#detalle-bloque-texto {
    /* Eliminamos el borde de foco del contenedor principal */
    outline: none;
    border: none;
    padding: 0; 
}

/* 救넖잺 NUEVO: Contenedor para cada fragmento enfocable 救넖잺 */
.detail-text-fragment {
    outline: none;
    padding: 10px; /* Padding interno para el fragmento */
    border-radius: 4px;
    /* Cambiamos a border-bottom-color para que no haya conflicto visual */
    border-bottom-color: transparent; 
    border-bottom-style: solid;
    border-bottom-width: 2px;
    transition: all 0.2s ease, filter 0.5s ease;
    will-change: filter, opacity;
    cursor: text;
    
    /* 救넖잺 CORRECCI칍N BLUR: Nivel base (Distancia 3+) = Distancia 2 救넖잺 */
    filter: blur(1.5px) grayscale(40%); 
    opacity: 0.6; 
    pointer-events: auto;
}

/* 救넖잺 FOCO: Asegurar nitidez al recibir foco (teclado/clic) 救넖잺 */
.detail-text-fragment:focus-visible,
.detail-text-fragment.focus-current { 
    /* 1. Resetear el filtro para nitidez inmediata */
    filter: none !important; 
    opacity: 1 !important;

    /* 2. Aplicar el borde y sombra sutil (menos desplazado y m치s tenue) */
    border-bottom-color: var(--color-primary);
    
    /* 救넖잺 AJUSTE SUTILEZA 救넖잺 */
    box-shadow: 
        0 1px 0 0 rgba(0, 123, 255, 0.1), /* Borde m치s fino */
        0 1px 3px var(--color-shadow-primary); 
    
    background-color: transparent; 
}


/* 3. EFECTO BLUR CON GRADIENTE DE PROXIMIDAD */
/* ---------------------------------------------------- */

/* 救넖잺 Foco Actual (Nitidez Completa) 救넖잺 */
.detail-text-fragment.focus-current,
.detail-action-item.focus-current {
    filter: none;
    opacity: 1;
}

/* 救넖잺 Fragmento/Acci칩n Adyacente 1 (M칤nimo desenfoque: 0.5px) 救넖잺 */
.detail-text-fragment.focus-adj-1,
.detail-action-item.focus-adj-1 {
    filter: blur(0.5px) grayscale(20%); 
    opacity: 0.9;
}

/* 救넖잺 Fragmento/Acci칩n Adyacente 2 (Desenfoque intermedio: 1.5px) 救넖잺 */
.detail-text-fragment.focus-adj-2,
.detail-action-item.focus-adj-2 {
    filter: blur(1.5px) grayscale(40%); 
    opacity: 0.6;
}

/* 救넖잺 BASE BLUR para las acciones (CORRECCI칍N: Nivel base Distancia 2) 救넖잺 */
.detail-action-item {
    transition: filter 0.5s ease, opacity 0.5s ease;
    filter: blur(1.5px) grayscale(40%); /* CORRECCI칍N */
    opacity: 0.6; /* CORRECCI칍N */
    pointer-events: auto; /* Permitir foco y click */
}
/* Re-habilitar clic en el bot칩n solo si el contenedor tiene el foco actual */
.detail-action-item.focus-current .detail-action-btn {
    pointer-events: auto;
}


/* --- M츼SCARAS (Controladas por las clases binarias mode-focus-text/actions) --- */

/* Foco en Texto -> Desenfoque de ACCIONES (Mismo nivel que el texto m치s lejano) */
.mode-focus-text #detalle-bloque-acciones {
    /* Las reglas de BLUR y OPACITY se definen en .detail-action-item por defecto (2px, 0.4) */
    pointer-events: none; 
    -webkit-mask-image: linear-gradient(to bottom, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.1) 100%);
    mask-image: linear-gradient(to bottom, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.1) 100%);
}


/* Foco en Acciones -> Desenfoque de TEXTO (Uniforme al nivel de desenfoque base) */
/* Las reglas de BLUR y OPACITY se definen en .detail-text-fragment por defecto (2px, 0.4) */
.mode-focus-actions .detail-text-fragment {
    pointer-events: none; /* Deshabilitar clics en texto */
    -webkit-mask-image: linear-gradient(to top, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.1) 100%);
    mask-image: linear-gradient(to top, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0.1) 100%);
}
.mode-focus-actions #detalle-bloque-acciones { 
    filter: none; opacity: 1; -webkit-mask-image: none; mask-image: none; 
}


/* 4. LISTA DE ACCIONES */
.detail-actions-list {
    display: flex; flex-direction: column; gap: 0; 
    margin-top: 15px; width: 100%; max-width: 100%; 
    border-top: 1px solid var(--color-border-placeholder); 
}

.detail-action-item {
    display: flex; justify-content: space-between; align-items: center;
    padding: 8px 5px; background: transparent;
    border-bottom: 1px solid var(--color-border-placeholder);
    transition: background-color 0.2s ease;
}
.detail-action-item:hover { background-color: rgba(255, 255, 255, 0.05); }

/* Texto de la acci칩n (Izquierda) */
.detail-action-text {
    font-size: 1rem; font-weight: 500; 
    color: var(--color-text); /* 救넖잺 FIJO: Nunca cambia de color 救넖잺 */
    text-align: left; margin-right: 15px; flex-grow: 1;
}


/* 5. BOT칍N DE ACCI칍N - ESTILO GHOST (Derecha) */
.detail-action-btn {
    display: flex; justify-content: center; align-items: center;
    /* 救넖잺 TAMA칌O EST츼NDAR (38px) 救넖잺 */
    width: 38px; 
    height: 38px; 
    background: transparent; 
    border: 2px solid var(--color-card-border); /* Borde Gris por defecto */
    border-radius: 50%; /* 救넖잺 HABILITADO: REDONDO 救넖잺 */
    
    /* Color de texto/icono por defecto */
    color: var(--color-text); 
    font-size: 1.2rem; line-height: 1;
    
    text-decoration: none; cursor: pointer;
    transition: all 0.2s ease; flex-shrink: 0; 
    position: relative; 
    overflow: hidden; 
}

/* 救넖잺 REQUISITO 3: Estado HOVER / FOCUS (Enabled) -> AZUL 救넖잺 */
/* HOVER: Solo Borde/Sombra, NO texto/icono color */
.detail-action-btn:not(.disabled):hover,
.detail-action-item:hover .detail-action-btn:not(.disabled) { 
    border-color: var(--color-primary);
    box-shadow: 0 0 15px var(--color-shadow-primary);
    transform: scale(1.1);
    color: var(--color-text); /* CLAVE: Mantiene el color del texto original en hover/label hover */
    outline: none;
}
/* FOCUS: Borde/Sombra + Color de texto/icono */
.detail-action-btn:not(.disabled):focus-visible {
    border-color: var(--color-primary);   
    color: var(--color-primary) !important;          /* 救넖잺 A칌ADIDO !important para asegurar el color AZUL en focus 救넖잺 */
    box-shadow: 0 0 15px var(--color-shadow-primary);
    transform: scale(1.1);
    outline: none;
}

/* ----------------------------------------------------- */
/* 救넖잺 ESTADO DISABLED: CUADRADO CON BORDES REDONDEADOS + 游뛂 救넖잺 */
/* ----------------------------------------------------- */

.detail-action-btn.disabled {
    color: var(--color-text-muted); 
    border: 2px solid var(--color-card-border-disabled); /* Borde gris visible */
    background: transparent;
    cursor: default; 
    
    /* 救넖잺 CORRECCI칍N TAMA칌O: COINCIDIR CON HABILITADO (38px) 救넖잺 */
    width: 38px; 
    height: 38px;
    border-radius: 8px; 
    
    /* ESTILO DEL EMOJI */
    font-size: 1.6rem; /* Ajustado para caber en 38px */
    line-height: 1;
    
    filter: none; 
    transform: none; 
    transition: all 0.2s ease; 
    pointer-events: auto; 
}

/* Aseguramos que solo se muestre el emoji 游뛂 (texto) */
.detail-action-btn.disabled .triangulo-svg,
.detail-action-btn.disabled .icon-wrapper,
.detail-action-btn.disabled > i {
    display: none !important; 
}


/* Hover: Zoom + Sombra (mantener color gris) */
.detail-action-btn.disabled:hover {
    outline: none;
    transform: scale(1.03); 
    border-color: var(--color-card-border); 
    box-shadow: 0 0 10px var(--color-shadow-disabled);
    color: var(--color-text-muted); /* Color del icono se mantiene gris */
}

/* Focus: Zoom + Foco Color (cambiar a blanco/gris oscuro) */
.detail-action-btn.disabled:focus-visible {
    outline: none;
    transform: scale(1.03); 
    border-color: var(--color-text); 
    box-shadow: 0 0 15px var(--color-shadow-disabled); 
    color: var(--color-text); /* Color del icono cambia a color de texto */
}


/* 6. ICONOS SVG */
.action-icon {
    display: inline-block; width: 20px; height: 20px;
    background-color: currentColor; 
    -webkit-mask-repeat: no-repeat; mask-repeat: no-repeat;
    -webkit-mask-position: center; mask-position: center;
    -webkit-mask-size: contain; mask-size: contain;
}
/* Flecha de Descarga (PWA) */
.icon-download { 
    -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 430.2 430.3"><path d="M230.3,0C240.6,3.6,244,11.1,244,21.8c-0.3,72.1-0.1,144.3-0.1,216.4c0,1.6,0,3.3,0,6c1.7-1.6,2.8-2.6,3.8-3.6c18.1-18.1,36.2-36.3,54.3-54.4c9.9-9.9,19.2-9.9,29.1,0c4.4,4.4,8.8,8.7,13.1,13.1c7.9,8.1,7.9,18.1-0.1,26.1c-38.6,38.7-77.2,77.3-115.9,115.9c-8.1,8.1-17.8,8.1-26,0c-38.7-38.6-77.3-77.2-115.9-115.8c-8-8-7.9-17.9-0.1-26.1c4.6-4.7,9.3-9.4,14-14c8.8-8.7,18.6-8.7,27.3,0c18.4,18.3,36.7,36.6,55,55c1.1,1.1,1.9,2.4,2.9,3.6c0.4-0.2,0.8-0.3,1.3-0.5c0-1.6,0-3.1,0-4.7c0-72.3,0.1-144.5-0.1-216.8c0-10.6,3.3-18.1,13.6-21.9C210.1,0,220.2,0,230.3,0zM56.3,430.3c-10.2-3.7-14.4-11.1-13.6-21.8c0.4-6.1,0-12.3,0.1-18.5c0.2-9.6,7.2-16.5,16.7-17c1.3-0.1,2.5,0,3.8,0c101.2,0,202.5,0,303.7,0c2.9,0,5.9,0.1,8.7,0.9c7,2,11.5,8,11.7,15.2c0.2,6.4-0.3,12.9,0.2,19.3c0.7,10.7-3.4,18.1-13.6,21.8C268.1,430.3,162.2,430.3,56.3,430.3z" fill="black"/></svg>'); 
    mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 430.2 430.3"><path d="M230.3,0C240.6,3.6,244,11.1,244,21.8c-0.3,72.1-0.1,144.3-0.1,216.4c0,1.6,0,3.3,0,6c1.7-1.6,2.8-2.6,3.8-3.6c18.1-18.1,36.2-36.3,54.3-54.4c9.9-9.9,19.2-9.9,29.1,0c4.4,4.4,8.8,8.7,13.1,13.1c7.9,8.1,7.9,18.1-0.1,26.1c-38.6,38.7-77.2,77.3-115.9,115.9c-8.1,8.1-17.8,8.1-26,0c-38.7-38.6-77.3-77.2-115.9-115.8c-8-8-7.9-17.9-0.1-26.1c4.6-4.7,9.3-9.4,14-14c8.8-8.7,18.6-8.7,27.3,0c18.4,18.3,36.7,36.6,55,55c1.1,1.1,1.9,2.4,2.9,3.6c0.4-0.2,0.8-0.3,1.3-0.5c0-1.6,0-3.1,0-4.7c0-72.3,0.1-144.5-0.1-216.8c0-10.6,3.3-18.1,13.6-21.9C210.1,0,220.2,0,230.3,0zM56.3,430.3c-10.2-3.7-14.4-11.1-13.6-21.8c0.4-6.1,0-12.3,0.1-18.5c0.2-9.6,7.2-16.5,16.7-17c1.3-0.1,2.5,0,3.8,0c101.2,0,202.5,0,303.7,0c2.9,0,5.9,0.1,8.7,0.9c7,2,11.5,8,11.7,15.2c0.2,6.4-0.3,12.9,0.2,19.3c0.7,10.7-3.4,18.1-13.6,21.8C268.1,430.3,162.2,430.3,56.3,430.3z" fill="black"/></svg>');
}
/* Enlace externo */
.icon-link { 
    -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>'); 
    mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>'); 
}
/* Carrito de compra (aunque se usa emoji, esta es la definici칩n de m치scara) */
.icon-buy { 
    -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 19.5c0 .829-.672 1.5-1.5 1.5s-1.5-.671-1.5-1.5c0-.828.672-1.5 1.5-1.5s1.5.672 1.5 1.5zm3.5-1.5c.829 0 1.5.671 1.5 1.5s-.671 1.5-1.5 1.5-1.5-.671-1.5-1.5c0-.828.671-1.5 1.5-1.5zm6.304-14.773l-3.23 10.428c-.271.867-1.127 1.488-2.079 1.488h-6.273c-.952 0-1.808-.621-2.079-1.488l-3.23-10.428h17.104zm-19.304-2.227l3.655 11.834c.061.197.168.375.297.534.129.158.283.298.455.409.172.112.358.199.553.256.195.058.397.089.601.089h6.273c.204 0 .406-.031.601-.089.195-.057.381-.144.553-.256.172-.111.326-.251.455-.409.129-.159.236-.337.297-.534l3.655-11.834h2.721v-2h-17.581v2h2.711z"/></svg>');
    mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 19.5c0 .829-.672 1.5-1.5 1.5s-1.5-.671-1.5-1.5c0-.828.672-1.5 1.5-1.5s1.5.672 1.5 1.5zm3.5-1.5c.829 0 1.5.671 1.5 1.5s-.671 1.5-1.5 1.5-1.5-.671-1.5-1.5c0-.828.671-1.5 1.5-1.5zm6.304-14.773l-3.23 10.428c-.271.867-1.127 1.488-2.079 1.488h-6.273c-.952 0-1.808-.621-2.079-1.488l-3.23-10.428h17.104zm-19.304-2.227l3.655 11.834c.061.197.168.375.297.534.129.158.283.298.455.409.172.112.358.199.553.256.195.058.397.089.601.089h6.273c.204 0 .406-.031.601-.089.195-.057.381-.144.553-.256.172-.111.326-.251.455-.409.129-.159.236-.337.297-.534l3.655-11.834h2.721v-2h-17.581v2h2.711z"/></svg>'); 
}


/* 7. Estilo Espec칤fico Bot칩n Volver M칩vil (P칤ldora) */
button.detail-action-btn {
    width: auto !important; height: auto !important;
    padding: 0.5rem 1rem !important; 
    border-radius: 20px !important; margin-bottom: 0; 
    font-weight: bold; aspect-ratio: auto; font-size: 1.1rem;
    background: var(--color-card-bg); 
}

/* Ajustes Padding */
@media (max-width: 600px) {
    #detalle-contenido-mobile {
        overflow-y: visible !important; height: auto !important; max-height: none !important;
    }
}