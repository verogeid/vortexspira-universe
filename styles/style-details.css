/* --- styles/style-details.css --- */

/* 1. Scroll interno y Contenedores */
/* Aplica tanto al contenedor de escritorio como al de móvil */
#detalle-contenido-desktop, 
#detalle-contenido-mobile {
    max-height: 100%; 
    overflow-y: auto; 
    padding-right: 10px;
    scrollbar-width: thin;
    scrollbar-color: var(--color-primary) transparent;
    /* Asegura comportamiento suave */
    scroll-behavior: smooth;
}

/* ⭐️ CORRECCIÓN CRÍTICA PARA SWIPER VERTICAL DE DETALLE ⭐️ */
/* Asegura que los slides en el carrusel de detalle solo midan lo que mide su contenido */
#detalle-swiper-desktop .swiper-slide,
#detalle-swiper-mobile .swiper-slide {
    height: auto !important; /* CLAVE: Deja que la altura se ajuste al contenido */
    max-height: none !important;
    margin-bottom: 0px; /* Espacio entre fragmentos */
    flex-shrink: 0; /* Asegura que no se encoja */
}


/* 2. BLOQUE DE TEXTO Y FRAGMENTOS */

/* Contenedor principal de texto (Ahora solo un wrapper) */
#detalle-bloque-texto {
    /* Eliminamos el borde de foco del contenedor principal */
    outline: none;
    border: none;
    padding: 0; 
}

/* ⭐️ NUEVO: Contenedor para cada fragmento enfocable ⭐️ */
.detail-text-fragment {
    outline: none;
    padding: 10px; /* Padding interno para el fragmento */
    border-radius: 4px;
    
    /* ⭐️ ELIMINACIÓN DE LA LÍNEA INFERIOR ⭐️ */
    border-bottom-color: transparent; 
    border-bottom-style: solid;
    border-bottom-width: 2px;
    
    /* ⭐️ AÑADIDO: Borde izquierdo para foco (por defecto transparente) ⭐️ */
    border-left: 4px solid transparent; 
    padding-left: 6px; /* Ajuste para compensar el borde de 4px */
    
    transition: all 0.2s ease, filter 0.5s ease;
    will-change: filter, opacity;
    cursor: text;
    
    /* ⭐️ CORRECCIÓN BLUR: Nivel base (Distancia 3+) = Distancia 2 ⭐️ */
    filter: blur(1.5px) grayscale(40%); 
    opacity: 0.6; 
    pointer-events: auto;
}

/* ⭐️ FOCO (focus-current / focus-visible): ESTILO GRIS Y BORDE IZQUIERDO ⭐️ */
.detail-text-fragment:focus-visible,
.detail-text-fragment.focus-current { 
    /* 1. Resetear el filtro para nitidez inmediata */
    filter: none !important; 
    opacity: 1 !important;
    
    /* ⭐️ FIX CLAVE: Borde izquierdo más grueso (gris/deshabilitado) ⭐️ */
    border-left: 4px solid var(--color-card-border-disabled) !important;
    
    /* ⭐️ APLICAR SOMBRA DE DESHABILITADO ⭐️ */
    box-shadow: 
        0 1px 0 0 rgba(0, 0, 0, 0.05),
        0 0 10px var(--color-shadow-disabled); /* Sombra tenue gris */
    
    /* ⭐️ Asegurar que el texto es nítido ⭐️ */
    color: var(--color-text) !important; 
    
    background-color: transparent; 
}

/* ⭐️ HOVER (focus-current-hover / :hover): ESTILO GRIS Y SOMBRA ⭐️ */
.detail-text-fragment.focus-current-hover, 
.detail-text-fragment:hover { 
    filter: none !important; 
    opacity: 1 !important;
    
    /* Mantener el borde izquierdo invisible si no tiene foco activo (focus-current) */
    border-left-color: transparent !important; 
    
    /* ⭐️ APLICAR SOMBRA DE DESHABILITADO ⭐️ */
    box-shadow: 
        0 1px 0 0 rgba(0, 0, 0, 0.05),
        0 0 10px var(--color-shadow-disabled); /* Sombra tenue gris */
}


/* 3. EFECTO BLUR CON GRADIENTE DE PROXIMIDAD */
/* ---------------------------------------------------- */

/* ⭐️ Foco Actual (Nitidez Completa) ⭐️ */
.detail-text-fragment.focus-current {
    filter: none;
    opacity: 1;
}

/* ⭐️ CORRECCIÓN: Estilos de la fila de acción ⭐️ */
.detail-action-item.focus-current {
    outline: none !important;
    border: none !important;
    box-shadow: none !important;
    filter: none !important; 
    opacity: 1 !important; 
}
/* CORRECCIÓN: Hover de la fila de acción (anula blur siempre) */
.detail-action-item:hover { 
    outline: none !important;
    border: none !important;
    box-shadow: none !important;
    filter: none !important; 
    opacity: 1 !important; 
}


/* ⭐️ Fragmento/Acción Adyacente 1 (Mínimo desenfoque: 0.5px) ⭐️ */
.detail-text-fragment.focus-adj-1,
.detail-action-item.focus-adj-1 {
    filter: blur(0.5px) grayscale(20%); 
    opacity: 0.9;
}

/* ⭐️ Fragmento/Acción Adyacente 2 (Desenfoque intermedio: 1.5px) ⭐️ */
.detail-text-fragment.focus-adj-2,
.detail-action-item.focus-adj-2 {
    filter: blur(1.5px) grayscale(40%); 
    opacity: 0.6;
}

/* ⭐️ BASE BLUR para las acciones y fragmentos (Nivel base Distancia 2) ⭐️ */
.detail-action-item {
    transition: filter 0.5s ease, opacity 0.5s ease;
    filter: blur(1.5px) grayscale(40%); 
    opacity: 0.6; 
    pointer-events: auto;
    
    outline: none;
    box-sizing: border-box; 
}
/* Re-habilitar clic en el botón solo si el contenedor tiene el foco actual */
.detail-action-item.focus-current .detail-action-btn {
    pointer-events: auto;
}


/* --- MÁSCARAS (Controladas por las clases binarias mode-focus-text/actions) --- */
.mode-focus-text #detalle-bloque-acciones {
}
.mode-focus-actions .detail-text-fragment {
}
.mode-focus-actions #detalle-bloque-acciones { 
    filter: none; opacity: 1; -webkit-mask-image: none; mask-image: none; 
}


/* 4. LISTA DE ACCIONES */
.detail-actions-list {
    display: flex; flex-direction: column; gap: 0; 
    margin-top: 15px; width: 100%; max-width: 100%; 
    border-top: 1px solid var(--color-border-placeholder); 
}

.detail-action-item {
    display: flex; justify-content: space-between; align-items: center;
    padding: 8px 5px; background: transparent;
    border-bottom: 1px solid var(--color-border-placeholder);
    transition: background-color 0.2s ease;
}
.detail-action-item:hover { background-color: rgba(255, 255, 255, 0.05); }

/* Texto de la acción (Izquierda) */
.detail-action-text {
    font-size: 1rem; font-weight: 500; 
    color: var(--color-text); 
    text-align: left; margin-right: 15px; flex-grow: 1;
}


/* 5. BOTÓN DE ACCIÓN - ESTILO GHOST (Derecha) */
.detail-action-btn {
    display: flex; justify-content: center; align-items: center;
    width: 38px; 
    height: 38px; 
    background: transparent; 
    border: 2px solid var(--color-card-border); 
    border-radius: 50%; 
    
    color: var(--color-text); 
    font-size: 1.2rem; line-height: 1;
    
    text-decoration: none; cursor: pointer;
    transition: all 0.2s ease; flex-shrink: 0; 
    position: relative; 
    overflow: hidden; 
}

/* ⭐️ ESTADO HABILITADO (Enabled) -> AZUL ⭐️ */
.detail-action-btn:not(.disabled):hover,
.detail-action-item:hover .detail-action-btn:not(.disabled) { 
    border-color: var(--color-primary);
    box-shadow: 0 0 15px var(--color-shadow-primary);
    transform: scale(1.1);
    color: var(--color-text); 
    outline: none;
}
.detail-action-btn:not(.disabled):focus-visible,
.detail-action-item.focus-current .detail-action-btn:not(.disabled) { 
    border-color: var(--color-primary);   
    color: var(--color-primary) !important;          
    box-shadow: 0 0 15px var(--color-shadow-primary);
    transform: scale(1.1);
    outline: none;
}

/* ⭐️ ESTADO DISABLED -> GRIS/DESHABILITADO ⭐️ */

.detail-action-btn.disabled {
    color: var(--color-text-muted); 
    border: 2px solid var(--color-card-border-disabled); 
    background: transparent;
    cursor: default; 
    
    width: 38px; 
    height: 38px;
    border-radius: 8px; 
    
    font-size: 1.6rem; 
    line-height: 1;
    
    filter: none; 
    transform: none; 
    transition: all 0.2s ease; 
    pointer-events: auto; 
}

/* Lógica de Iconos (sin cambios) */
.detail-action-btn.disabled .triangulo-svg,
.detail-action-btn.disabled .icon-wrapper,
.detail-action-btn.disabled > i:not(.icon-vacio) { 
    display: none !important; 
}
.detail-action-btn.disabled > i.icon-vacio { 
    display: block !important;
}


/* Hover/Focus de botón deshabilitado */
.detail-action-btn.disabled:hover,
.detail-action-item:hover .detail-action-btn.disabled { 
    outline: none;
    transform: scale(1.03); 
    border-color: var(--color-card-border); 
    box-shadow: 0 0 10px var(--color-shadow-disabled);
    color: var(--color-text); 
}
.detail-action-btn.disabled:focus-visible,
.detail-action-item.focus-current .detail-action-btn.disabled { 
    outline: none;
    transform: scale(1.03); 
    border-color: var(--color-text); 
    box-shadow: 0 0 15px var(--color-shadow-disabled); 
    color: var(--color-text); 
}


/* 6. ICONOS SVG y 7. Estilos Específicos (Sin cambios) */
.action-icon {
    display: inline-block; width: 20px; height: 20px;
    background-color: currentColor; 
    -webkit-mask-repeat: no-repeat; mask-repeat: no-repeat;
    -webkit-mask-position: center; mask-position: center;
    -webkit-mask-size: contain; mask-size: contain;
}
.icon-download { 
    -webkit-mask-image: var(--icon-download); 
    mask-image: var(--icon-download); 
}
.icon-link { 
    -webkit-mask-image: var(--icon-link); 
    mask-image: var(--icon-link); 
}
.icon-buy { 
    -webkit-mask-image: var(--icon-buy); 
    mask-image: var(--icon-buy); 
}
.icon-vacio { 
    -webkit-mask-image: var(--icon-vacio); 
    mask-image: var(--icon-vacio); 
}

button.detail-action-btn {
    width: auto !important; height: auto !important;
    padding: 0.5rem 1rem !important; 
    border-radius: 20px !important; margin-bottom: 0; 
    font-weight: bold; aspect-ratio: auto; font-size: 1.1rem;
    background: var(--color-card-bg); 
}

/* --- styles/style-details.css --- */