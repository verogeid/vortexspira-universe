/* --- styles/style-safe-mode.css --- */

/* ============================================================
   üö® MODO DE SEGURIDAD UNIFICADO (Reflow WCAG 1.4.10) üö®
   Se activa v√≠a JS (data-safe-mode="true")
   ============================================================ */
/*@media (max-height: 500px) */

/* 1. Liberamos el BODY para permitir scroll nativo */
body[data-layout="mobile"][data-safe-mode="true"] {
    position: static !important;
    overflow-y: auto !important; 
    height: auto !important;
    padding-top: 0 !important; /* El padding lo dar√°n los elementos ahora est√°ticos */
    padding-bottom: 0 !important;
}

/* 3. El Contenedor Principal fluye entre header y footer */
body[data-layout="mobile"][data-safe-mode="true"] #app-container {
    height: auto !important;
    min-height: 0 !important;
    overflow: visible !important;
    display: block !important; /* Quitamos flex/grid complejos */

    padding-top: 2px !important;
    margin-top: 0 !important;
}

/* Ajuste fino para que el texto no toque literalmente el borde de la pantalla */
body[data-layout="mobile"][data-safe-mode="true"] .detail-text-fragment,
body[data-layout="mobile"][data-safe-mode="true"] .detail-title-slide {
    padding: 0;
    padding-left: 4px !important;
    padding-right: 4px !important;
}

/* 4. Soltamos el Swiper para que se muestre como lista vertical simple */
body[data-layout="mobile"][data-safe-mode="true"] #nav-swiper-mobile, 
body[data-layout="mobile"][data-safe-mode="true"] #detalle-swiper-mobile {
    height: auto !important;
    overflow: visible !important;
}

body[data-layout="mobile"][data-safe-mode="true"] .swiper-wrapper {
    height: auto !important;
    padding-bottom: 4px !important;
    padding-top: 0 !important;
    margin-top: 0 !important;
}

body[data-layout="mobile"][data-safe-mode="true"] .swiper-slide {
    height: auto !important;
    margin-bottom: 20px !important; /* Separaci√≥n manual entre cards */
}
/* 3. Forzar que el primer slide (Breadcrumb) suba del todo */
body[data-layout="mobile"][data-safe-mode="true"] .swiper-slide:first-child {
    margin-top: 0 !important;
    padding-top: 0 !important;
}
/* 4. Ajuste espec√≠fico para la tarjeta Breadcrumb */
body[data-layout="mobile"][data-safe-mode="true"] .card.card-breadcrumb-vertical {
    margin-top: 0 !important;
    /* Reducimos tambi√©n su altura m√≠nima si es necesario para ganar espacio */
    min-height: 40px !important; 
}

/* ============================================================
   üö® REGLAS SAFE MODE PARA HEADER üö®
   Cuando el espacio es cr√≠tico, priorizamos la visibilidad del
   bot√≥n A11y sacrificando el texto del t√≠tulo.
   ============================================================ */

body[data-layout="mobile"][data-safe-mode="true"] #header-content-wrapper {
    /* Forzamos que no haga wrap para mantener la l√≠nea */
    flex-wrap: nowrap !important;
    gap: 5px;
}

body[data-layout="mobile"][data-safe-mode="true"] header h1 {
    /* Restauramos posici√≥n relativa para que fluya */
    position: relative !important;
    left: auto !important;
    transform: none !important;
    
    /* FLEXIBILIDAD: Ocupa espacio pero encoge si es necesario */
    flex: 1 1 auto !important;
    min-width: 0 !important; /* Vital para que el truncado funcione en Flex */
    width: auto !important;
    max-width: none !important;
    
    /* Puntos suspensivos forzados */
    white-space: nowrap !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
    
    margin: 0 clamp(2px, 1dvh, 5px) !important;
    display: block !important; /* Comportamiento de bloque para el overflow */
    padding: 0 !important;     /* Eliminamos padding extra para ganar espacio */
}

/* Aseguramos que el logo y el texto est√©n alineados inline dentro del bloque truncado */
body[data-layout="mobile"][data-safe-mode="true"] header h1 a {
    display: inline-flex !important;
    vertical-align: middle;
}

/* üö® Footer deja de flotar y fluye con el documento */
body[data-layout="mobile"][data-safe-mode="true"] footer {
    position: relative !important; /* Se mueven con el scroll */
    height: auto !important;       /* Crecen seg√∫n el tama√±o de la letra */
    min-height: auto !important;
    padding: 10px !important;
    z-index: 10;
}

body[data-layout="mobile"][data-safe-mode="true"] .footer-social-container {
    display: none !important;
}

/* 1. SOLTAR EL CONTENEDOR PRINCIPAL DE LA VISTA */
/* Antes estaba fixed/absolute. Ahora debe fluir en el documento */
body[data-safe-mode="true"] #vista-detalle-mobile,
body[data-safe-mode="true"] #vista-detalle-desktop {
    position: relative !important; /* Vital: deja de flotar sobre todo */
    top: auto !important;
    left: auto !important;
    width: 100% !important;
    height: auto !important;
    display: block !important;
    overflow: visible !important;
    padding-bottom: 20px;
}

/* 2. SOLTAR EL CONTENEDOR DEL SWIPER */
body[data-layout="mobile"][data-safe-mode="true"] #detalle-swiper-mobile,
body[data-safe-mode="true"] #detalle-swiper-desktop {
    height: auto !important;
    overflow: visible !important;
}

/* 3. APILAR LOS SLIDES VERTICALMENTE */
/* Swiper usa flex-row por defecto. Lo forzamos a columna */
body[data-layout="mobile"][data-safe-mode="true"] #detalle-swiper-mobile .swiper-wrapper,
body[data-safe-mode="true"] #detalle-swiper-desktop .swiper-wrapper {
    display: flex !important;
    flex-direction: column !important; /* ‚¨ÖÔ∏è LA CLAVE: Uno debajo de otro */
    height: auto !important;
    transform: none !important; /* Eliminar desplazamientos residuales */
    
    gap: var(--detail-vertical-spacing) !important;

    box-sizing: border-box;
}

/* 4. RESTAURAR LOS SLIDES INDIVIDUALES */
body[data-layout="mobile"][data-safe-mode="true"] .swiper-slide {
    width: 100% !important;
    height: auto !important;
    display: block !important;
    margin: 0 !important; /* El gap del wrapper ya separa */
    flex-shrink: 0 !important;
    opacity: 1 !important;
    visibility: visible !important;

    margin-bottom: var(--detail-vertical-spacing) !important;
}

/* 5. ARREGLAR LOS FRAGMENTOS DE TEXTO */
/* Deben crecer todo lo que necesite el texto */
body[data-layout="mobile"][data-safe-mode="true"] .detail-text-fragment {
    height: auto !important;
    max-height: none !important;
    overflow: visible !important;
    white-space: normal !important;
}

body[data-layout="mobile"][data-safe-mode="true"] .detail-text-fragment .content-wrapper {
    position: relative !important;
    top: auto !important;
    transform: none !important;

    padding: var(--detail-vertical-spacing, 2px) !important;

    width: 100% !important;
    max-width: 100% !important;
}
body[data-layout="mobile"][data-safe-mode="true"] .detail-text-fragment p {
    margin-bottom: 10px !important; /* Margen fijo en px, no en em/rem */
    font-size: inherit; /* Asegurar que hereda el tama√±o "capado" */
}

/* 6. ASEGURAR VISIBILIDAD DEL T√çTULO */
body[data-layout="mobile"][data-safe-mode="true"] .detail-title-slide {
    height: auto !important;
    margin-top: 10px;
    margin-bottom: 20px;
    white-space: normal !important; /* Que el t√≠tulo salte de l√≠nea si es largo */
}

/* --- styles/style-safe-mode.css --- */