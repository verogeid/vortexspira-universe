/* --- styles/style-safe-mode.css --- */

/* 1. RESET GLOBAL DEL SCROLL Y ESTRUCTURA
   Liberamos el body para que tenga scroll nativo y altura autom치tica */
body[data-layout="mobile"][data-safe-mode="true"] {
    position: static !important;
    overflow-y: auto !important;
    height: auto !important;
    padding-top: 0 !important;
    
    /* Preferencia guardada: Sin negritas */
    font-weight: normal !important;
    
    --detail-vertical-spacing: var(--sm-detail-vertical-spacing);

    /* T칤tulo: M치ximo 24px (1.5 l칤neas en 320px) */
    --details-title-slide-font-size: var(--sm-details-title-slide-font-size);
    
    /* Texto cuerpo: M치ximo 18px (Lectura c칩moda sin desbordar) */
    --details-text-fragment-font-size: var(--sm-details-text-fragment-font-size);
    
    /* Botones de Acci칩n: Cr칤tico para que no ocupen todo el ancho */
    --details-action-btn-font-size: var(--sm-details-action-btn-font-size); 
    --details-action-btn-size: var(--sm-details-action-btn-size); /* Altura m치xima f칤sica */
    --details-action-icon-size: var(--sm-details-action-icon-size);
    --details-action-text-font-size: var(--sm-details-action-text-font-size);
    
    /* Bot칩n Volver interno */
    --details-volver-btn-font-size: var(--sm-details-volver-btn-font-size);

    /* --- MENU M칍VIL: Topes f칤sicos --- */
    --header-title-size: var(--sm-mobile-header-title-size);
    --header-logo-size: var(--sm-mobile-header-logo-size);
    --header-icon-size: var(--sm-mobile-header-icon-size);
    --header-obras-size: var(--sm-mobile-header-obras-size);

    --card-title-font-size: var(--sm-card-title-font-size);
    --card-desc-font-size: var(--sm-card-desc-font-size);
    
    --card-breadcrump-vertical-h3-font-size: var(--sm-card-breadcrump-vertical-h3-font-size);
    --card-nivel-actual-h3-font-size: var(--sm-card-nivel-actual-h3-font-size);
    --card-volver-fija-h3-font-size: var(--sm-card-volver-fija-h3-font-size);

    --card-padding: var(--sm-mobile-card-padding);
    --card-gap: var(--sm-mobile-card-gap);

    --a11y-title-font-size: var(--sm-a11y-title-font-size);
    --a11y-section-font-size: var(--sm-a11y-section-font-size);
    --a11y-close-btn-font-size: var(--sm-a11y-close-btn-font-size);
    --a11y-close-btn-size: var(--sm-a11y-close-btn-size); /* Touch Target seguro */
    --a11y-option-btn-font-size: var(--sm-a11y-option-btn-font-size);
    --a11y-slider-icon-size: var(--sm-a11y-slider-icon-size);
    --a11y-range-value-font-size: var(--sm-a11y-range-value-font-size);

    /* Footer */
    --footer-font-size: var(--sm-footer-font-size);
    --footer-social-link-size: var(--sm-footer-social-link-size);
}

/* 2. DESBLOQUEO DE CONTENEDORES PRINCIPALES
   Deben dejar de medir 100vh para poder empujar el footer hacia abajo */
body[data-layout="mobile"][data-safe-mode="true"] #app-container,
body[data-layout="mobile"][data-safe-mode="true"] #vista-central,
body[data-layout="mobile"][data-safe-mode="true"] #vista-detalle-mobile {
    position: static !important; /* Deja de flotar sobre el contenido */
    display: block !important;   /* Simplificamos grids/flex complejos */
    height: auto !important;
    overflow: visible !important; /* Permite que el contenido salga */
    
    /* Asegura que el footer no se monte encima */
    padding-bottom: 0 !important;
    margin-bottom: 0 !important;
}

body[data-layout="mobile"][data-safe-mode="true"] .a11y-modal-overlay {
    padding-right: var(--card-padding);
}

/* 3. TRANSFORMACI칍N DE SWIPERS A LISTA VERTICAL 
   Esta es la clave para que veas todo el contenido de un vistazo */
body[data-layout="mobile"][data-safe-mode="true"] #nav-swiper-mobile, 
body[data-layout="mobile"][data-safe-mode="true"] #detalle-swiper-mobile {
    height: auto !important;
    overflow: visible !important;
    
    /* 游뚿 CR칈TICO: Devuelve el scroll t치ctil al usuario (arregla el dedo bloqueado) */
    touch-action: auto !important;
}

body[data-layout="mobile"][data-safe-mode="true"] .swiper-wrapper {
    /* Pone los slides uno debajo de otro */
    display: flex !important;
    flex-direction: column !important; 
    height: auto !important;
    
    /* Reseteo de transformaciones de Swiper JS */
    transform: none !important; 
    box-sizing: border-box !important;
}

body[data-layout="mobile"][data-safe-mode="true"] .swiper-slide {
    height: auto !important;
    width: 100% !important;
    flex-shrink: 0 !important;
    display: block !important;
    margin: 0 !important;
}

body[data-layout="mobile"][data-safe-mode="true"] .card {
    min-height: auto !important;
}

/* 4. FOOTER AL FINAL
   Al ser 'position: relative', si el contenido de arriba crece,
   el footer baja autom치ticamente. */
body[data-layout="mobile"][data-safe-mode="true"] footer {
    position: relative !important;
    height: auto !important;
    width: 100% !important;
    display: block !important;
    margin-top: 20px !important;

    padding-right: var(--sm-mobile-card-padding);
}

body[data-layout="mobile"][data-safe-mode="true"] .footer-social-link {
    display: none !important;
}

/* 5. CONTROL DE TIPOGRAF칈A (Accesibilidad y Preferencias) */
body[data-layout="mobile"][data-safe-mode="true"] * {
    /* 游뚿 Preferencia de usuario: NUNCA negritas en los posts/textos */
    font-weight: normal !important;
}

/* Ajuste espec칤fico para que los t칤tulos no se vean extra침os sin negrita */
body[data-layout="mobile"][data-safe-mode="true"] h1,
body[data-layout="mobile"][data-safe-mode="true"] h2,
body[data-layout="mobile"][data-safe-mode="true"] h3 {
    font-weight: normal !important;
    /* Un poco m치s de interlineado ayuda cuando no hay negrita */
    line-height: 1.4 !important; 

    /* Puntos suspensivos forzados */
    white-space: normal !important;
    overflow: hidden !important;
    text-overflow: ellipsis !important;
}

/* 6. HEADER EN FLUJO NATURAL
   Al cambiarlo a relative, el header ocupa espacio f칤sico y 
   empuja el contenido hacia abajo. Ya no tapa nada. */
body[data-layout="mobile"][data-safe-mode="true"] header {
    left: auto !important;
    width: 100% !important;
    
    /* Aseguramos que se vea bien */
    height: auto !important;
    min-height: var(--header-height, 50px);
    
    /* Opcional: Si quieres que se quede pegado arriba al hacer scroll 
       cambia 'relative' por 'sticky' y descomenta la siguiente l칤nea: */
    top: 0 !important; position: sticky !important; z-index: 1000;
    padding-right: var(--sm-mobile-card-padding);
}

body[data-layout="mobile"][data-safe-mode="true"] header h1 {
    /* 1. ACTIVAR EL MOTOR DE RECORTE (Igual que en tus cards) */
    display: -webkit-box !important;
    -webkit-box-orient: vertical !important;
    
    /* 2. CONFIGURACI칍N DE L칈NEAS */
    /* Cu치ntas l칤neas permites antes de cortar? 2 suele ser ideal para header */
    -webkit-line-clamp: 2 !important; 
    line-clamp: 2 !important;
    
    /* 3. COMPORTAMIENTO DEL TEXTO */
    white-space: normal !important; /* Permite saltar de l칤nea */
    overflow: hidden !important;    /* Oculta lo que sobre */
    text-overflow: ellipsis !important; /* Pone los puntos ... */
    
    /* 4. AJUSTES VISUALES */
    /* Quitamos el centrado flex anterior porque choca con -webkit-box */
    text-align: center !important; 
    width: 100% !important;
    max-width: 100% !important;
    
    /* Aseguramos que el texto rompa si es una palabra kilom칠trica */
    word-break: break-word !important; 
    overflow-wrap: anywhere !important; 
    
    /* Reset de alturas para que el clamp funcione */
    height: auto !important;
    max-height: none !important;
    
    /* Ajuste fino de m치rgenes */
    margin: 0 auto !important;
}

/* Ajuste para el enlace dentro del H1 para que no rompa el bloque */
body[data-layout="mobile"][data-safe-mode="true"] header h1 a {
    display: inline !important; /* Vital para que el texto fluya dentro del box */
}

/* --- styles/style-safe-mode.css --- */